---
layout: layouts/base.njk
pagination:
  data: products
  size: 1
  alias: product
permalink: "products/{{ product.id }}/"
eleventyComputed:
  title: "{{ product.name }}"
  description: "{{ product.shortDescription or product.description }}"
  tags: ["product", "{{ product.category | slugify }}"]
  localeLinks:
    es: "/es/productos/{{ product.id }}/"
---

{% set translations = collections.i18n and collections.i18n[0].data.i18n %}
{% set defaultLocale = site.locale | default('en') %}
{% set currentLocale = locale | default(defaultLocale) %}
{% set localeStrings = translations and translations[currentLocale] %}
{% if localeStrings == null and translations and translations['en'] %}
  {% set localeStrings = translations['en'] %}
{% endif %}
{% set fallbackStrings = translations and translations['en'] %}
{% set aiStrings = localeStrings and localeStrings.ui and localeStrings.ui.aiGenerated %}
{% if (aiStrings == null or aiStrings == undefined) and fallbackStrings %}
  {% set aiStrings = fallbackStrings.ui and fallbackStrings.ui.aiGenerated %}
{% endif %}
{% set aiBadgeLabel = aiStrings and aiStrings.badge or 'AI-generated concept' %}
{% set aiDetailNote = aiStrings and aiStrings.detail or 'This recipe concept was generated with AI assistance and refined by our team before publishing.' %}

<article class="product-detail">
  <header class="product-detail__header">
    <a class="product-detail__back" href="{{ '/products/' | url }}">← Back to catalog</a>
    <h1>{{ product.name }}</h1>
    <p class="product-detail__summary">{{ product.shortDescription }}</p>
    {% if product.aiGenerated %}
      <p class="product-detail__ai-note" role="note">
        <strong class="product-detail__ai-label">{{ aiBadgeLabel }}</strong>
        {{ aiDetailNote }}
      </p>
    {% endif %}
    {% if product.labels and product.labels | length %}
      <ul class="product-detail__labels">
        {% for label in product.labels %}
          <li class="product-detail__label">{{ label }}</li>
        {% endfor %}
      </ul>
    {% endif %}
    <div class="product-detail__meta">
      <span class="product-detail__price">${{ product.price }} <small>{{ product.unit }}</small></span>
      <span class="product-detail__category">{{ product.category }}</span>
      {% if product.heatLevel != null %}
        <span class="product-detail__heat">Heat: {{ product.heatLevel }}/5</span>
      {% endif %}
    </div>
    {% if site.snipcart.publicKey %}
      <div class="product-detail__purchase">
        <label class="product-detail__quantity-label" for="quantity-{{ product.id }}">Quantity</label>
        <input
          id="quantity-{{ product.id }}"
          class="product-detail__quantity"
          type="number"
          min="1"
          value="1"
          inputmode="numeric"
          autocomplete="off">
        <button
          class="button button-primary product-detail__cart snipcart-add-item"
          type="button"
          data-item-id="{{ product.id }}"
          data-item-name="{{ product.name }}"
          data-item-price="{{ product.price }}"
          data-item-url="{{ page.url | url }}"
          data-item-description="{{ product.shortDescription }}"
          data-item-image="{{ product.image.src | url }}"
          data-item-quantity="1"
          data-quantity-input="quantity-{{ product.id }}">
          Add to cart
        </button>
      </div>
    {% else %}
      <div class="product-detail__purchase product-detail__purchase--disabled" role="note">
        <p class="product-detail__availability">
          Online ordering is coming soon. Email us to reserve a batch or ask about availability.
        </p>
        <a class="button button-secondary" href="{{ '/contact/' | url }}">Contact us</a>
      </div>
    {% endif %}
  </header>

  <div class="product-detail__body">
    <figure class="product-detail__figure">
      {% if product.image.src | isSvg %}
        <img src="{{ product.image.src | url }}" alt="{{ product.image.alt }}" loading="lazy" decoding="async">
      {% else %}
        {% responsiveImage product.image.src, product.image.alt, 'product-detail__image' %}
      {% endif %}
    </figure>
    <section class="product-detail__content">
      <h2>About this product</h2>
      <p>{{ product.description }}</p>

      {% if product.includedProducts and product.includedProducts | length %}
        <h3>{{ product.includedHeading | default("What's inside") }}</h3>
        <ul class="product-detail__list">
          {% for item in product.includedProducts %}
            <li>
              {% if item.quantity %}<strong>{{ item.quantity }}×</strong> {% endif %}
              {{ item.name }}
              {% if item.note %}
                <span class="product-detail__note">{{ item.note }}</span>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% endif %}

      {% if product.bundleExtras and product.bundleExtras | length %}
        <h3>{{ product.bundleExtrasHeading | default("Bundle perks") }}</h3>
        <ul class="product-detail__list">
          {% for extra in product.bundleExtras %}
            <li>{{ extra }}</li>
          {% endfor %}
        </ul>
      {% endif %}

      {% if product.ingredients and product.ingredients | length %}
        <h3>Ingredients</h3>
        <ul class="product-detail__list">
          {% for ingredient in product.ingredients %}
            <li>{{ ingredient }}</li>
          {% endfor %}
        </ul>
      {% endif %}

      {% if product.dietary and product.dietary | length %}
        <h3>Dietary Notes</h3>
        <ul class="product-detail__tags">
          {% for tag in product.dietary %}
            <li>{{ tag }}</li>
          {% endfor %}
        </ul>
      {% endif %}

      {% if product.benefits and product.benefits | length %}
        <h3>Functional Highlights</h3>
        <ul class="product-detail__tags">
          {% for benefit in product.benefits %}
            <li>{{ benefit }}</li>
          {% endfor %}
        </ul>
      {% endif %}

      {% if product.subscription %}
        <div class="product-detail__subscription">
          <h3>{{ product.subscription.heading | default("Subscription perks") }}</h3>
          {% if product.subscription.frequency %}
            <p class="product-detail__note">{{ product.subscription.frequency }}</p>
          {% endif %}
          {% if product.subscription.summary %}
            <p>{{ product.subscription.summary }}</p>
          {% endif %}
          {% if product.subscription.perks and product.subscription.perks | length %}
            <ul class="product-detail__list">
              {% for perk in product.subscription.perks %}
                <li>{{ perk }}</li>
              {% endfor %}
            </ul>
          {% endif %}
          {% if product.subscription.renewalNote %}
            <p class="product-detail__note">{{ product.subscription.renewalNote }}</p>
          {% endif %}
        </div>
      {% endif %}

      {% if product.shippingNote %}
        <p class="product-detail__note">{{ product.shippingNote }}</p>
      {% endif %}
    </section>
  </div>
</article>
